
<script>
  function pick (workitemPath) {
    var form = document.getElementById('workitem_delegation_form');
    form.action = workitemPath;
    form.submit();
  }
</script>

<div class='content_title'>/workitems</div>

<table class='coll' style="width: 100%;">
  <tr class="nhover">
    <th>wfid</th>
    <th>workflow</th>
    <th>since</th>
    <th>expid</th>
    <th>store</th>
    <th>participant</th>
    <th>activity</th>
  </tr>
<% for workitem in @workitems %>
  <tr class="workitem">
    <td><%= link_to_slice(workitem, :wfid) %></td>
    <td><%= link_to_slice(workitem, :wf_name, :workflow) %> <%= h workitem.wf_revision %></td>
    <td><%= display_since(workitem, :dispatch_time) %></td>
    <td><%= h workitem.full_fei.expid %></td>
    <td><%= link_to_slice(workitem, :store_name, :store) %></td>
    <td><%= link_to_slice(workitem, :participant_name, :participant) %></td>
    <td><%= h workitem.activity %></td>
    <td class="coll_buttons">
      <%= link_to 'show', workitem_url(workitem) %> |
      <%= link_to 'edit', edit_workitem_url(workitem) %> |
      <%= link_to_function 'pick', "pick('#{workitem_url(workitem)}');" %>
    </td>
  </tr>
<% end -%>
</table>

<% if request.query_string.size > 0 %>
<div class="workitems_nav align-right">
  <%= link_to_if(
    request.query_string.size > 0,  'all', :controller => 'workitems') %>
</div>
<% end %>

<% form_tag(
  '/none',
  :id => 'workitem_delegation_form',
  :method => :put,
  :multipart => true) do -%>

  <input type="hidden" name="store_name" id="store_name" value="<%= current_user.login %>" />
<% end %>

